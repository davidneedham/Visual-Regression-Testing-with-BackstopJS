<!DOCTYPE html>
<html lang="en">
<head>
	<title>Visual Regression Testing with BackstopJS</title>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="pantheon-theme/styles/screen-16x10.css">
	<!--<link rel="stylesheet" href="node_modules/shower-ribbon/styles/screen-16x10.css">
	-->
</head>
<body class="shower list">

	<header class="caption">
		<h1>Visual Regression Testing with BackstopJS</h1>
		<p>Brought to you by the folks at Pantheon</p>
	</header>

	<section class="slide" id="cover">
		<div class="title">
			<div class="background"></div>
			<div class="text">
				<h2>Visual Regression Testing with BackstopJS</h2>
			</div>
		</div>
		<figure>
			<img class="cover" src="pantheon-theme/pictures/pantheon-office.jpg" alt="The Pagoda atop the Pantheon office">
			<figcaption class="white">
				<a href="http://www.twitter.com/getpantheon">@getpantheon</a>
			</figcaption>
		</figure>
	</section>

	<section class="slide bio image-r">
		<div class="text">
			<h2>Hi, I'm David</h2>
			<p>Developer Advocate at Pantheon</p>
			<p><strong>davidneedham</strong> on <a href="#">GitHub</a> and <a href="https://www.twitter.com/davidneedham">Twitter</a></p>
			<p><a href="mailto:david.needham@pantheon.io">david.needham@pantheon.io</a></p>
			<p>Some things I enjoy are:</p>
				<ul>
					<li>Biking with my wife and kids</li>
					<li>Board games: <a href="http://is.gd/davidsgames">is.gd/davidsgames</a></li>
					<li>Volunteering in the community</li>
				</ul>
			<figure>
				<img class="cover" src="/pictures/David-Needham-Pantheon.jpg" alt="David Needham">
			</figure>
		</div>
	</section>

	<section class="slide bio image-r">
		<div class="text">
			<h2>Hi, I'm Dwayne</h2>
			<p>Developer Advocate at Pantheon</p>
			<p><strong>mcdwayne</strong> on <a href="https://www.twitter.com/mcdwayne">Twitter</a>, <a href="#">Drupal.org</a>, <a href="#">WordPress.org</a>, <a href="#">GitHub</a></p>
			<p><a href="mailto:dwayne@pantheon.io">dwayne@pantheon.io</a></p>
			<p>Some things I enjoy are:</p>
				<ul>
					<li>Improv</li>
					<li>Karaoke</li>
					<li>Webcomics and comic books</li>
					<li>Finger knitting and crochet</li>
				</ul>
			<figure>
				<img class="cover" src="/pictures/Dwayne-McDaniel-Pantheon.jpg" alt="David Needham">
			</figure>
		</div>
	</section>

	<section class="slide bio image-r">
		<div class="text">
			<h2>Hi, I'm Rachel</h2>
			<p>Senior Technical Writer at Pantheon</p>
			<p><strong>rachwhitton</strong> on <a href="https://www.twitter.com/RachWhitton">Twitter</a></p>
			<p>Some things I enjoy are:</p>
				<ul>
					<li>Camping</li>
					<li>Reading</li>
					<li>Gaming</li>
				</ul>
			<figure>
				<img class="cover" src="/pictures/Rachel-Whitton-Pantheon.jpg" alt="Rachel Whitton">
			</figure>
		</div>
	</section>

	<section class="slide">
		<h2>Agenda</h2>
		<table>
		<tr>
			<td>Intro and setup</td>
		</tr>
		<tr>
			<td>Visual Regression Testing</td>
		</tr>
		<tr>
			<td>BackstopJS</td>
		</tr>
		<tr>
			<td>Continuous Integration</td>
		</tr>
		<tr>
			<td>Q&A // Breakout Sessions</td>
		</tr>
		</table>
	</section>

	<section class="slide">
		<h2>Logistics</h2>
		<strong>You need:</strong>
		<ul>
			<li>A local dev environment with <a href="#">NodeJS/NPM</a></li>
			<li>A website with:</li>
			<ul>
				<li>A live, web-accessible website</li>
				<li>A local copy (or development site)</li>
			</ul>
			<li>Windows users need <a href="#">Python</a> installed</li>
			<li>Afer class, install <a href="#">BackstopJS</a> globally to keep going</li>
		</ul>
	</section>

	<section class="slide subtitle">
		<div class="title">
			<div class="background"></div>
			<div class="text one-line">
				<h2>Visual Regression Testing</h2>
			</div>
		</div>
	</section>

	<section class="slide">
		<h2>Visual Regression: The New Pixel Perfect</h2>
		<ul>
			<li>The Power of Machine Vision</li>
			<li>Diligent Difference Detection</li>
			<li>Easy to create, quick to run</li>
			<li>Powered by Wraith or BackstopJS</li>
		</ul>
	</section>

	<section class="slide screenshot">
		<p>Before:</p>
		<figure class="center">
			<img class="" src="/pictures/visual-regression-before.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<p>After:</p>
		<figure class="center">
			<img class="" src="/pictures/visual-regression-after.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<p>Side by side:</p>
		<figure class="half first">
			<img class="" src="/pictures/visual-regression-before.png" alt="Placeholder">
		</figure>
		<figure class="half second last">
			<img class="" src="/pictures/visual-regression-after.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<p>Difference:</p>
		<figure class="center">
			<img class="" src="/pictures/visual-regression-difference.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Visual Regression Benefits</h2>
			<ul>
				<li>"Reference vs Test" Comparison</li>
				<ul>
					<li>Reference (production)</li>
					<li>Test (environment to compare)</li>
				</ul>
				<li>Support for multiple viewports</li>
				<li>Easily scan your entire site</li>
				<li>Helpful error reporting</li>
				<li>Easy to write tests</li>
			</ul>
		</div>
		<figure class="">
			<img class="cover
			" src="/pictures/visual-regression-report.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Visual Regression Limitations</h2>
			<ul>
				<li>Lots of noise in the testing process</li>
				<li>High number of false positives</li>
				<li>Difficulties with dynamic content</li>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/noisy-texture-300x300-o100-d11-c-ffffff-t0.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<h2>Security updates as a killer use case</h2>
		<figure>
			<img class="" src="/pictures/D6-update-module-report.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<h2>Security updates & visual changes</h2>
		<figure class="half first">
			<img class="" src="/pictures/pantheondemo-before.png" alt="Placeholder">
		</figure>
		<figure class="half second last">
			<img class="" src="/pictures/pantheondemo-after.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide subtitle">
		<div class="title">
			<div class="background"></div>
			<div class="text one-line">
				<h2>BackstopJS</h2>
			</div>
		</div>
	</section>

	<section class="slide">
		<h2>BackstopJS</h2>
		<strong>BackstopJS automates visual regression testing like a boss!</strong>
		<ul>
			<li>Render with headless Chrome, Phantom, and Slimer</li>
			<li>Simulate user interactions with ChromJS and CasperJS scripts</li>
			<li><strong>Browser reports with visual diffs</strong>, CLI reports and JUnit reports</li>
			<li>Plays nice with CI and source control</li>
			<li>Run globally or locally as a <strong>standalone packaged app with Node</strong></li>
			<li>Incredibly easy to use: just 3 commands go a long, long way!</li>
		</ul>
		<p><a href="https://github.com/garris/BackstopJS">github.com/garris/BackstopJS</a></p>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Clone the example repo</h2>
			<p>We've created <a href="#">an example repo</a> to help you get setup locally.</p>
			<p>There are detailed instructions in <a href="#">the README</a> but you can get started by cloning the repo.</p>
		</div>

		<code class="block">git clone https://github.com/ataylorme/loopconf-2018-automated-update-workshop.git</code>
		<figure>
			<img class="cover" src="/pictures/loopconf-workshop-repo-screenshot.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Running the example</h2>
			<ul>
				<li>Checkout a new branch: <code>git checkout -b backstop-hacking-1</code></li>
				<li>Install Node dependencies: <code>npm install</code></li>
				<li>Run the example script: <code>npm run start</code></li>
				<li>Wait for the results (it should open in your browser automatically)</li>
			</ul>
		</div>
	</section>

	<section class="slide screenshot">
		<h2>Viewing the results</h2>
		<figure>
			<img class="" src="/pictures/hacking-step-1-results.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<h2>Backstop.json file</h2>
		<figure>
			<img class="" src="/pictures/Screen Shot 2018-01-16 at 4.18.14 PM.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Hacking the example</h2>
			<ul>
				<li>Edit <code>includes/backstop.json</code></li>
				<ul>
					<li>Set <code>referenceUrl</code> in <code>scenarios</code> to your production site URL</li>
					<li>Set <code>url</code> in <code>scenarios</code> to your local / development URL</li>
					<li>Start your local environment if needed</li>
				</ul>
				<li>Rerun the script with <code>npm run start</code></li>
				<li>Wait for the results (it should open in your browser automatically)</li>
			</ul>
		</div>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Hacking the example (pt 2)</h2>
			<ul>
				<li>Edit <code>includes/backstop.json</code></li>
				<ul>
					<li>Try changing <code>viewports</code> or adding more <code>scenarios</code> to test other pages</li>
				</ul>
				<li>Update the website on your local / development URL</li>
				<li>Rerun the script with <code>npm run start</code></li>
				<li><strong>Is your updated site different than production?</strong></li>
			</ul>
		</div>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Scaling BackstopJS</h2>
			<p>We've tested one site at a time. What happens when you need to update all your sites? How can we scale BackstopJS?</p>
		</div>
		<figure>
			<img class="cover" src="/pictures/graph-up.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Running the multiple site example</h2>
			<ul>
				<li>Commit your existing changes</li>
				<li>Checkout the branch: <code>git checkout multiple-sites</code></li>
				<li>Checkout a new branch to work on: <code>git checkout -b backstop-hacking-2</code></li>
				<li>Re-install Node dependies: <code>npm install</code></li>
				<li>Rerun the example script: <code>npm run start</code></li>
				<ul>
					<li>Type a site name from the list</li>
				</ul>
				<li>Wait for the results</li>
			</ul>
		</div>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Running the multiple site example (pt 2)</h2>
			<ul>
				<li>Run the command <code>npm run start -- --all</code> (note the extra <code>--</code>)</li>
				<li>Wait for the results (from multiple sites!)</li>
				<li>Edit <code>includes/sitesToUpdate.js</code>. (This is where we list all of the sites to test.)</li>
				<ul>
					<li>Try changing to one (or more) of your sites</li>
					<li><code>BackstopReferenceBaseUrl</code> is your local / development URL</li>
					<li><code>BackstopTestUrl</code> is your production site URL</li>
					<li><code>pathsToTest</code> is the array of URIs to test for each site</li>
				</ul>
				<li>Wait for the results</li>
			</ul>
		</div>
	</section>

	<section class="slide">
		<div class="text">
			<h2>Running the multiple site example (pt3)</h2>
			<ul>
				<li><code>npm run start</code> tests a single site</li>
				<ul>
					<li><code>npm run start -- --site=my-cool-site</code> to specify a site without prompting</li>
				</ul>
				<li><code>npm run start -- --all</code> tests all the sites in <code>includes/sitesToUpdate.js</code></li>
				<li>Backstop config doesn't hae to be hard-coded JSON</li>
				<ul>
					<li>See <code>includes/backstopConfig.js</code> for a dynamic configuration example</li>
				</ul>
			</ul>
		</div>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Automatically configuring BackstopJS</h2>
			<p><a href"#">backstop-crawl</a> is a tool for automatically generating the <code>backstop.json</code> required for <a href="#">BackstopJS</a> by crawling a website with <a href="#">NodeJS</a>.</p>
			<p>Great for brochure and smaller sites without tons of pages.</p>
		</div>
		<figure>
			<img class="" src="/pictures/backstop-crawl.gif" alt="Placeholder">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Configuring BackstopJS Manually</h2>
			<ul>
				<li>Crawling isn't so great for larger sites with hundreds or thousands of pages.</li>
				<li>With large sites it is best to create a <code>backstop.json</code> manually covering the templates you need (single, archive, landing page, etc.)</li>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/custom-backstop-json.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide subtitle">
		<div class="title">
			<div class="background"></div>
			<div class="text one-line">
				<h2>Continuous Integration</h2>
			</div>
		</div>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>You can do this manually</h2>
			<ul>
				<li>Updates <strong>can</strong> be done manually</li>
				<li>Testing <strong>can</strong> be done manually</li>
			</ul>
			<p>If you can run a script while you brush your teeth, your sites can be as fresh as your mouth!</p>
		</div>
		<figure>
			<img class="" src="/pictures/manual-labor.png" alt="Placeholder">
		</figure>
	</section>

	<section class="slide screenshot">
		<figure class="center">
			<img class="" src="/pictures/cron-job.png" alt="Placeholder">
		</figure>
		<p>* */12 * * * /bin/bash /Users/me/Scripts/update-my-site.sh >/dev/null 2>&1</p>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>But make the robots do the work</h2>
			<ul>
				<li>Robots are happy to help!</li>
				<li>Lots of benefits:</li>
					<ul>
						<li>Reliability</li>
						<li>Error logging</li>
						<li>Reporting</li>
						<li>"Greenfield" environments</li>
					</ul>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/robots.png" alt="David Needham">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>Putting it together with CI</h2>
			<ul>
				<li>CircleCI makes it all happen!</li>
				<li>Easy to setup. Easy to configure.</li>
				<li>Let robots do the work!</li>
				<li>Share your work with others.</li>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/circle-ci.png" alt="David Needham">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>CI Basics: Setup</h2>
			<ul>
				<li>Pick a Docker container</li>
				<ul><li>Preinstalled: Linux + NGINX + MariaDB + PHP</li></ul>
				<li>Define environmental variables</li>
				<ul>
					<li>API + Credentials</li>
					<li>Site specific information</li>
				</u>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/choices.png" alt="David Needham">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>CI Basics: Build</h2>
			<ul>
				<li>Build necessary tooling</li>
				<ul><li>Install BackstopJS / other tools</li></ul>
				<li>Configure hosting platform</li>
				<ul>
					<li>Setup dev environments</li>
					<li>Copy production DB/Files</li>
				</u>
				<li>Apply udates to Dev</li>
				<ul>
					<li>Update Dev instance</li>
					<li>Notify via Slack</li>
				</u>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/build.png" alt="David Needham">
		</figure>
	</section>

	<section class="slide image-r">
		<div class="text">
			<h2>CI Basics: Test</h2>
			<ul>
				<li>Run testing</li>
				<ul><li>Visual regression, Behat, etc...</li></ul>
				<li>Determine success</li>
				<ul><li>Pass or fail?</li></ul>
				<li>Apply updates</li>
				<ul>
					<li>Update live instance</li>
					<li>Notify via Slack</li>
				</u>
			</ul>
		</div>
		<figure>
			<img class="cover" src="/pictures/test.png" alt="David Needham">
		</figure>
	</section>

	<section class="slide subtitle">
		<div class="title">
			<div class="background"></div>
			<div class="text one-line">
				<h2>Q&A</h2>
			</div>
		</div>
	</section>

	<section class="slide subtitle">
		<div class="title">
			<div class="background"></div>
			<div class="text one-line">
				<h2>Breakout sessions</h2>
			</div>
		</div>
	</section>

	<footer class="badge">
		<a href="https://github.com/davidneedham/Visual-Regression-Testing-with-BackstopJS">Fork this on GitHub</a>
	</footer>

	<div class="progress"></div>

	<script src="node_modules/shower-core/shower.min.js"></script>
	<!-- Copyright © 2018 Yours Truly, Famous Inc. -->

</body>
</html>
